name: Deployment
on:
  push

jobs:
  backend:
    name: Back-End
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - name: Setup
        run: echo "${{secrets.FIREBASE_KEY}}" > ./keys/firebase.json
      - uses: akhileshns/heroku-deploy@v3.12.12
        with:
          heroku_api_key: ${{secrets.HEROKU_API_KEY}}
          heroku_app_name: "flat-share-api"
          heroku_email: "jcha686@aucklanduni.ac.nz"
          appdir: "packages/backend"
        env:
          HD_PING_TEXT: "prod"
          HD_DATABASE_URL: ${{secrets.DATABASE_URI}}
          HD_PORT: 80
